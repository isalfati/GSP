Welcome. This program analyzes the data of different contaminants in the air of Catalonia.
Right now is configured to analyze the following contaminant: o3.

Importing data...

Obtaining info about stations...

Filling gaps of information...

Summary of the stations: 
    CODI EOI                        NOM ESTACIÓ                MUNICIPI    LATITUD   LONGITUD  ALTITUD TIPUS ESTACIÓ
0    8015021                           Badalona                Badalona  41.443985  2.2378986        7    background
1    8019043               Barcelona (Eixample)               Barcelona  41.385315  2.1537998       26       traffic
2    8019044  Barcelona (Gràcia - Sant Gervasi)               Barcelona  41.398724  2.1533988       57       traffic
3    8019050             Barcelona (Ciutadella)               Barcelona  41.386406  2.1873982        7    background
4    8019054       Barcelona (Parc Vall Hebron)               Barcelona   41.42611  2.1480017      136    background
5    8019057            Barcelona (Palau Reial)               Barcelona   41.38749  2.1151996       81    background
6    8019058      Barcelona (Observatori Fabra)               Barcelona   41.41843  2.1238973      415    background
7    8089005                               Gavà                    Gavà  41.303097  1.9914981       25    background
8    8125002                  Montcada i Reixac       Montcada i Reixac   41.48197  2.1882975       34       traffic
9    8169009     El Prat de Llobregat (Sagnier)   Prat de Llobregat, el  41.321774     2.0821        7    background
10   8184006                               Rubí                    Rubí  41.492115  2.0424972      171    background
11   8187012                           Sabadell                Sabadell  41.561214  2.1011107      210       traffic
12   8194008                Sant Adrià de Besòs     Sant Adrià de Besòs  41.425594  2.2221997        7    industrial
13   8205002              Sant Cugat del Vallès   Sant Cugat del Vallès  41.476814  2.0889983      113    background
14   8263001     Sant Vicenç dels Horts (Ribot)  Sant Vicenç dels Horts   41.39219  2.0097985       38    background
15   8301004                Viladecans - Atrium              Viladecans   41.31335  2.0136087       14    background 

Obtaining matrix of distances...

The constant Tau is: 11.7423.

Obtaining matrix of weights and adjacencies...

Summary of the matrices:
Distances Matrix:
0.0	9.5862	8.6699	7.6629	7.7714	12.0249	9.9424	25.8795	5.9135	18.8164	17.1762	17.3191	2.4277	12.9635	19.9182	23.7175
9.5862	0.0	1.4896	2.8129	4.5566	3.2376	4.4473	16.3677	11.1152	9.2629	15.0739	20.0255	7.2611	11.5154	12.0683	14.1962
8.6699	1.4896	0.0	3.1555	3.0748	3.4297	3.2977	17.2154	9.6946	10.4225	13.9094	18.5676	6.4804	10.2073	12.0312	15.0579
7.6629	2.8129	3.1555	0.0	5.5042	6.04	6.3911	18.8264	10.6138	11.3653	16.8667	20.7094	5.2355	12.9794	14.868	16.6543
7.7714	4.5566	3.0748	5.5042	0.0	5.0912	2.1881	18.924	7.0587	12.8324	11.4647	15.5076	6.2026	7.4846	12.1541	16.8301
12.0249	3.2376	3.4297	6.04	5.0912	0.0	3.5124	13.9655	12.1422	7.8064	13.1126	19.3302	9.8973	10.1594	8.8309	11.8356
9.9424	4.4473	3.2977	6.3911	2.1881	3.5124	0.0	16.9352	8.8746	11.2899	10.6409	15.9718	8.2561	7.1099	9.9758	14.8777
25.8795	16.3677	17.2154	18.8264	18.924	13.9655	16.9352	0.0	25.7984	7.8651	21.4215	30.0955	23.6154	20.9458	10.0126	2.1737
5.9135	11.1152	9.6946	10.6138	7.0587	12.1422	8.8746	25.7984	0.0	19.8848	12.2282	11.4202	6.8722	8.3135	17.9439	23.7513
18.8164	9.2629	10.4225	11.3653	12.8324	7.8064	11.2899	7.8651	19.8848	0.0	19.206	26.6402	16.4414	17.2287	9.8876	5.8106
17.1762	15.0739	13.9094	16.8667	11.4647	13.1126	10.6409	21.4215	12.2282	19.206	0.0	9.101	16.7332	4.2391	11.4294	20.0004
17.3191	20.0255	18.5676	20.7094	15.5076	19.3302	15.9718	30.0955	11.4202	26.6402	9.101	0.0	18.1416	9.4282	20.2625	28.4832
2.4277	7.2611	6.4804	5.2355	6.2026	9.8973	8.2561	23.6154	6.8722	16.4414	16.7332	18.1416	0.0	12.4996	18.1429	21.4465
12.9635	11.5154	10.2073	12.9794	7.4846	10.1594	7.1099	20.9458	8.3135	17.2287	4.2391	9.4282	12.4996	0.0	11.4957	19.2182
19.9182	12.0683	12.0312	14.868	12.1541	8.8309	9.9758	10.0126	17.9439	9.8876	11.4294	20.2625	18.1429	11.4957	0.0	8.7618
23.7175	14.1962	15.0579	16.6543	16.8301	11.8356	14.8777	2.1737	23.7513	5.8106	20.0004	28.4832	21.4465	19.2182	8.7618	0.0

Adjacency Matrix:
0.0	1.0	1.0	1.0	1.0	1.0	1.0	0.0	1.0	1.0	1.0	1.0	1.0	1.0	1.0	0.0
1.0	0.0	1.0	1.0	1.0	1.0	1.0	1.0	1.0	1.0	1.0	0.0	1.0	1.0	1.0	1.0
1.0	1.0	0.0	1.0	1.0	1.0	1.0	1.0	1.0	1.0	1.0	1.0	1.0	1.0	1.0	1.0
1.0	1.0	1.0	0.0	1.0	1.0	1.0	1.0	1.0	1.0	1.0	0.0	1.0	1.0	1.0	1.0
1.0	1.0	1.0	1.0	0.0	1.0	1.0	1.0	1.0	1.0	1.0	1.0	1.0	1.0	1.0	1.0
1.0	1.0	1.0	1.0	1.0	0.0	1.0	1.0	1.0	1.0	1.0	1.0	1.0	1.0	1.0	1.0
1.0	1.0	1.0	1.0	1.0	1.0	0.0	1.0	1.0	1.0	1.0	1.0	1.0	1.0	1.0	1.0
0.0	1.0	1.0	1.0	1.0	1.0	1.0	0.0	0.0	1.0	0.0	0.0	0.0	0.0	1.0	1.0
1.0	1.0	1.0	1.0	1.0	1.0	1.0	0.0	0.0	1.0	1.0	1.0	1.0	1.0	1.0	0.0
1.0	1.0	1.0	1.0	1.0	1.0	1.0	1.0	1.0	0.0	1.0	0.0	1.0	1.0	1.0	1.0
1.0	1.0	1.0	1.0	1.0	1.0	1.0	0.0	1.0	1.0	0.0	1.0	1.0	1.0	1.0	0.0
1.0	0.0	1.0	0.0	1.0	1.0	1.0	0.0	1.0	0.0	1.0	0.0	1.0	1.0	0.0	0.0
1.0	1.0	1.0	1.0	1.0	1.0	1.0	0.0	1.0	1.0	1.0	1.0	0.0	1.0	1.0	0.0
1.0	1.0	1.0	1.0	1.0	1.0	1.0	0.0	1.0	1.0	1.0	1.0	1.0	0.0	1.0	1.0
1.0	1.0	1.0	1.0	1.0	1.0	1.0	1.0	1.0	1.0	1.0	0.0	1.0	1.0	0.0	1.0
0.0	1.0	1.0	1.0	1.0	1.0	1.0	1.0	0.0	1.0	0.0	0.0	0.0	1.0	1.0	0.0

Weight Matrix:
0.0	0.5135	0.5798	0.6532	0.6453	0.3504	0.4882	0.0	0.776	0.0767	0.1177	0.1136	0.9582	0.2956	0.0563	0.0
0.5135	0.0	0.984	0.9442	0.8602	0.9268	0.8664	0.1433	0.4082	0.5367	0.1924	0.0	0.6822	0.3822	0.3477	0.2319
0.5798	0.984	0.0	0.9303	0.9337	0.9182	0.9242	0.1165	0.5058	0.4548	0.2458	0.0821	0.7374	0.4697	0.35	0.1931
0.6532	0.9442	0.9303	0.0	0.8027	0.7675	0.7436	0.0765	0.4417	0.3919	0.127	0.0	0.8197	0.2947	0.2012	0.1338
0.6453	0.8602	0.9337	0.8027	0.0	0.8286	0.9659	0.0745	0.6967	0.3029	0.3855	0.1748	0.7565	0.6661	0.3425	0.1282
0.3504	0.9268	0.9182	0.7675	0.8286	0.0	0.9144	0.243	0.3433	0.6428	0.2874	0.0665	0.4914	0.473	0.568	0.3621
0.4882	0.8664	0.9242	0.7436	0.9659	0.9144	0.0	0.1249	0.5648	0.3968	0.4399	0.1572	0.61	0.6931	0.4859	0.2008
0.0	0.1433	0.1165	0.0765	0.0745	0.243	0.1249	0.0	0.0	0.6385	0.0	0.0	0.0	0.0	0.4833	0.9663
0.776	0.4082	0.5058	0.4417	0.6967	0.3433	0.5648	0.0	0.0	0.0568	0.3381	0.3883	0.71	0.6058	0.0968	0.0
0.0767	0.5367	0.4548	0.3919	0.3029	0.6428	0.3968	0.6385	0.0568	0.0	0.0689	0.0	0.1408	0.1162	0.4921	0.7828
0.1177	0.1924	0.2458	0.127	0.3855	0.2874	0.4399	0.0	0.3381	0.0689	0.0	0.5484	0.1312	0.8778	0.3877	0.0
0.1136	0.0	0.0821	0.0	0.1748	0.0665	0.1572	0.0	0.3883	0.0	0.5484	0.0	0.0919	0.5248	0.0	0.0
0.9582	0.6822	0.7374	0.8197	0.7565	0.4914	0.61	0.0	0.71	0.1408	0.1312	0.0919	0.0	0.322	0.0919	0.0
0.2956	0.3822	0.4697	0.2947	0.6661	0.473	0.6931	0.0	0.6058	0.1162	0.8778	0.5248	0.322	0.0	0.3835	0.0687
0.0563	0.3477	0.35	0.2012	0.3425	0.568	0.4859	0.4833	0.0968	0.4921	0.3877	0.0	0.0919	0.3835	0.0	0.5731
0.0	0.2319	0.1931	0.1338	0.1282	0.3621	0.2008	0.9663	0.0	0.7828	0.0	0.0	0.0	0.0687	0.5731	0.0

Laplacian Matrix (Normalized):
1.0	-0.076	-0.084	-0.102	-0.093	-0.052	-0.07	0.0	-0.134	-0.014	-0.024	-0.033	-0.158	-0.05	-0.011	0.0
-0.076	1.0	-0.12	-0.123	-0.104	-0.114	-0.104	-0.03	-0.059	-0.084	-0.033	0.0	-0.094	-0.054	-0.056	-0.043
-0.084	-0.12	1.0	-0.118	-0.11	-0.111	-0.109	-0.024	-0.072	-0.069	-0.042	-0.019	-0.099	-0.065	-0.055	-0.035
-0.102	-0.123	-0.118	1.0	-0.101	-0.099	-0.094	-0.017	-0.067	-0.064	-0.023	0.0	-0.118	-0.044	-0.034	-0.026
-0.093	-0.104	-0.11	-0.101	1.0	-0.099	-0.113	-0.015	-0.098	-0.046	-0.065	-0.041	-0.101	-0.092	-0.053	-0.023
-0.052	-0.114	-0.111	-0.099	-0.099	1.0	-0.109	-0.05	-0.049	-0.1	-0.049	-0.016	-0.067	-0.067	-0.09	-0.066
-0.07	-0.104	-0.109	-0.094	-0.113	-0.109	1.0	-0.025	-0.079	-0.06	-0.074	-0.037	-0.081	-0.095	-0.075	-0.036
0.0	-0.03	-0.024	-0.017	-0.015	-0.05	-0.025	1.0	0.0	-0.167	0.0	0.0	0.0	0.0	-0.129	-0.299
-0.134	-0.059	-0.072	-0.067	-0.098	-0.049	-0.079	0.0	1.0	-0.01	-0.068	-0.109	-0.114	-0.1	-0.018	0.0
-0.014	-0.084	-0.069	-0.064	-0.046	-0.1	-0.06	-0.167	-0.01	1.0	-0.015	0.0	-0.024	-0.021	-0.099	-0.182
-0.024	-0.033	-0.042	-0.023	-0.065	-0.049	-0.074	0.0	-0.068	-0.015	1.0	-0.184	-0.025	-0.173	-0.086	0.0
-0.033	0.0	-0.019	0.0	-0.041	-0.016	-0.037	0.0	-0.109	0.0	-0.184	1.0	-0.025	-0.144	0.0	0.0
-0.158	-0.094	-0.099	-0.118	-0.101	-0.067	-0.081	0.0	-0.114	-0.024	-0.025	-0.025	1.0	-0.051	-0.016	0.0
-0.05	-0.054	-0.065	-0.044	-0.092	-0.067	-0.095	0.0	-0.1	-0.021	-0.173	-0.144	-0.051	1.0	-0.07	-0.014
-0.011	-0.056	-0.055	-0.034	-0.053	-0.09	-0.075	-0.129	-0.018	-0.099	-0.086	0.0	-0.016	-0.07	1.0	-0.136
0.0	-0.043	-0.035	-0.026	-0.023	-0.066	-0.036	-0.299	0.0	-0.182	0.0	0.0	0.0	-0.014	-0.136	1.0

Eigenvalues or "Graph Adjacency Spectrum":

 [0.         0.5171252  0.73280692 0.95068992 1.07262596 1.09778141
 1.11409833 1.11745668 1.11959348 1.12685848 1.14162047 1.1622101
 1.16364736 1.16448107 1.2185181  1.3004865 ]

Eigenvectors:
-0.242	0.199	0.209	0.459	0.187	0.171	-0.13	0.006	0.012	-0.029	0.131	-0.534	-0.064	-0.507	0.041	0.005
-0.289	0.008	0.221	-0.232	-0.268	0.12	0.045	0.019	-0.411	-0.719	0.008	0.128	-0.007	-0.145	0.036	-0.012
-0.296	0.052	0.181	-0.183	-0.18	-0.04	0.189	-0.193	0.84	-0.17	-0.003	0.008	-0.008	-0.04	-0.019	-0.007
-0.276	0.068	0.285	-0.063	-0.274	0.377	0.251	-0.063	-0.187	0.515	-0.497	0.045	-0.007	-0.025	0.033	-0.006
-0.298	0.12	0.076	-0.081	0.189	-0.495	0.511	0.535	-0.097	0.123	0.11	-0.032	0.13	-0.036	0.031	-0.0
-0.292	-0.066	0.087	-0.335	-0.056	-0.07	-0.705	0.392	0.08	0.241	0.058	0.156	-0.109	-0.163	-0.044	-0.02
-0.299	0.061	0.024	-0.251	0.278	-0.372	-0.09	-0.711	-0.237	0.176	0.107	0.021	0.087	-0.079	0.029	-0.006
-0.173	-0.515	-0.104	0.286	-0.016	-0.057	0.106	-0.043	0.0	0.028	0.014	0.227	-0.115	-0.197	-0.133	-0.688
-0.248	0.233	-0.06	0.426	0.058	-0.311	-0.261	0.013	0.026	-0.218	-0.577	0.094	0.089	0.291	-0.217	0.012
-0.23	-0.371	0.013	0.011	-0.347	-0.073	-0.103	-0.006	-0.074	0.04	0.158	-0.591	0.225	0.488	0.039	-0.038
-0.208	0.162	-0.506	-0.137	-0.032	0.287	0.082	0.014	-0.023	0.03	0.131	-0.051	0.301	-0.112	-0.663	0.036
-0.149	0.205	-0.502	0.181	-0.384	-0.047	-0.049	-0.018	0.023	0.063	0.072	0.171	0.272	-0.187	0.592	-0.004
-0.261	0.185	0.25	0.325	0.113	0.286	-0.021	-0.013	-0.011	0.082	0.522	0.412	0.036	0.428	0.005	0.015
-0.253	0.178	-0.392	-0.096	0.035	0.061	0.095	0.0	-0.045	-0.02	0.016	-0.161	-0.796	0.232	0.093	-0.046
-0.225	-0.264	-0.172	-0.172	0.618	0.38	-0.007	0.098	0.097	-0.147	-0.235	-0.032	0.249	0.118	0.347	-0.008
-0.195	-0.519	-0.099	0.238	-0.038	-0.067	0.087	-0.038	-0.004	0.025	0.01	0.179	-0.164	-0.16	-0.075	0.722

Obtaining pollution data matrix, please wait...

Amount of data missing per station:

4.0, 5.0, 8.0, 5.0, 30.0, 30.0, 5.0, 3.0, 11.0, 5.0, 12.0, 34.0, 51.0, 22.0, 5.0, 2.0

Finding columns to be dropped...

These are the stations that do not fullfill the 0.85 constraint:
[]

Index of those columns:
[]

Size Data Set pre-Drop NA: 672.
Size Data Set post-Drop NA: 488.

MEAN: 28.83606557377049.
Reconstructing data on station: Barcelona (Eixample). For the second round, the faulty station will be: Barcelona (Ciutadella).

@@@@@@@@@@@@@@@@@@@@
@@@ Data Set: #0 @@@
@@@@@@@@@@@@@@@@@@@@

Splitting data set...

@@@@@@@@@@ LC @@@@@@@@@@
Linear Combination Reconstruction...

Linear combination RMSE: 15.773407412860717.
                    MBE: 11.940235359259061.
                    R2: 0.5025955006442.


@@@@@@@@@@ MLR @@@@@@@@@@
Linear Regression - ML...
Summary of Training:

Coefficient of Determination: 0.892644661864197.
Intercept: -2.0291624177256438.
Slope: [ 0.05556079  0.41971097  0.45786397 -0.08443898  0.02064748  0.00116142
  0.01998753 -0.11982939  0.08146202  0.0726285  -0.14007817 -0.04979548
  0.16263539 -0.02775988].

Linear Regression RMSE: 9.946604668761571.
                   MBE: -3.125336722338962.
                    R2: 0.8022081548790407.


@@@@@@@@@@ Stankovic @@@@@@@@@@
Stankovic Method...

Stankovic RMSE: 13.072801622107878.
           MBE: 9.281806783242436.
            R2: 0.658338526634358.

@@@@@@@@@@@@@@@@@@@@
@@@ Data Set: #1 @@@
@@@@@@@@@@@@@@@@@@@@

Error on faulty station: 10.0%.
Splitting data set...

@@@@@@@@@@ LC @@@@@@@@@@
Linear Combination Reconstruction...

Linear combination RMSE: 15.764025923484489.
                    MBE: 11.923775051007192.
                    R2: 0.503187003443475.


@@@@@@@@@@ MLR @@@@@@@@@@
Linear Regression - ML...
Summary of Training:

Coefficient of Determination: 0.8878112406757147.
Intercept: -2.5939344974307588.
Slope: [ 0.06628002  0.42644871  0.41441779 -0.08785311  0.01967427  0.00827516
  0.02272629 -0.1223389   0.08974948  0.08612601 -0.13202623 -0.0515897
  0.16284256 -0.02548501].

Linear Regression RMSE: 9.765680729666554.
                   MBE: -3.1111940488819623.
                    R2: 0.8093381901897935.


@@@@@@@@@@ Stankovic @@@@@@@@@@
Stankovic Method...

Stankovic RMSE: 13.036740786319193.
           MBE: 9.255884549068766.
            R2: 0.6602208477597826.

@@@@@@@@@@@@@@@@@@@@
@@@ Data Set: #2 @@@
@@@@@@@@@@@@@@@@@@@@

Error on faulty station: 15.0%.
Splitting data set...

@@@@@@@@@@ LC @@@@@@@@@@
Linear Combination Reconstruction...

Linear combination RMSE: 15.783556921842607.
                    MBE: 11.928925921003982.
                    R2: 0.5019551779137421.


@@@@@@@@@@ MLR @@@@@@@@@@
Linear Regression - ML...
Summary of Training:

Coefficient of Determination: 0.8835147438867551.
Intercept: -1.7038804901227387.
Slope: [ 0.07440876  0.4347554   0.36941814 -0.08977285  0.03602673 -0.00403827
  0.01734518 -0.10989065  0.09113875  0.08072047 -0.10625576 -0.07141405
  0.15153536 -0.01803626].

Linear Regression RMSE: 9.539997457495515.
                   MBE: -3.363293959854839.
                    R2: 0.8180486904921145.


@@@@@@@@@@ Stankovic @@@@@@@@@@
Stankovic Method...

Stankovic RMSE: 13.02411519231895.
           MBE: 9.26399630835126.
            R2: 0.6608786557788373.

@@@@@@@@@@@@@@@@@@@@
@@@ Data Set: #3 @@@
@@@@@@@@@@@@@@@@@@@@

Error on faulty station: 20.0%.
Splitting data set...

@@@@@@@@@@ LC @@@@@@@@@@
Linear Combination Reconstruction...

Linear combination RMSE: 15.687562025092431.
                    MBE: 11.827450176664632.
                    R2: 0.5079949284059696.


@@@@@@@@@@ MLR @@@@@@@@@@
Linear Regression - ML...
Summary of Training:

Coefficient of Determination: 0.8713833550932886.
Intercept: -2.0342229472880824.
Slope: [ 0.06635875  0.47172427  0.309348   -0.08935512  0.03565124  0.00393042
 -0.00729637 -0.09515837  0.10639136  0.0934616  -0.07862486 -0.07333674
  0.12946899 -0.0146017 ].

Linear Regression RMSE: 9.717704879976571.
                   MBE: -3.858667209021443.
                    R2: 0.8112069167955827.


@@@@@@@@@@ Stankovic @@@@@@@@@@
Stankovic Method...

Stankovic RMSE: 13.004706265039948.
           MBE: 9.104188972579625.
            R2: 0.661888640269676.

